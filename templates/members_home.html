{% extends "layout2.html" %}

{% block content %}
<main>
    <!-- Existing Content -->
    <section id="events-section">
        <h2>Upcoming Events</h2>
        {% if events %}
            {% for event in events %}
                <div class="event">
                    <h3>{{ event.title }}</h3>
                    <p><strong>Date:</strong> {{ event.date }}</p>
                    <p><strong>Location:</strong> {{ event.location }}</p>
                    {% if event.poster %}
                        <img src="{{ url_for('uploaded_file', filename=event.poster) }}" alt="{{ event.title }} poster">
                    {% endif %}
                    <p><strong>Privacy:</strong> {{ event.privacy }}</p>
                    {% if event.privacy == 'private' %}
                        <p><strong>RSVP Link:</strong> <a href="{{ url_for('rsvp', title=event.title) }}">RSVP Here</a></p>
                    {% endif %}
                    <a href="{{ url_for('event_details', event_id=event.id) }}">See Details</a>
                </div>
            {% endfor %}
        {% else %}
            <p>No upcoming events created.</p>
        {% endif %}
    </section>

    <!-- Feedback Section -->
    <section id="feedback-section">
        <h2>We Value Your Feedback!</h2>
        <form action="{{ url_for('submit_feedback') }}" method="POST">
            <label for="event_attended">Have you ever attended or hosted a party with us?</label>
            <select id="event_attended" name="event_attended" required>
                <option value="attended">Attended</option>
                <option value="hosted">Hosted</option>
                <option value="both">Both</option>
                <option value="none">None</option>
            </select>
            
            <label for="feedback">Your Feedback (up to 200 words):</label>
            <textarea id="feedback" name="feedback" rows="4" maxlength="1000" required></textarea>
            
            <button type="submit">Submit Feedback</button>
        </form>
    </section>

    <!-- Testimonials Section -->
    <section id="testimonials-section">
        <h2>What Our Users Are Saying</h2>
        {% if testimonials %}
            {% for testimonial in testimonials %}
                <div class="testimonial">
                    <p>"{{ testimonial.feedback }}" - {{ testimonial.user_name }}</p>
                </div>
            {% endfor %}
        {% else %}
            <p>No testimonials yet. Be the first to share your experience!</p>
        {% endif %}
    </section>
</main>
{% endblock %}

{% block scripts %}
<script>
    function toggleSeeMore(event) {
        event.preventDefault(); // Prevent default link behavior
        const seeMoreSection = document.querySelector('.see-more');
        const button = document.querySelector('.see-more-link');
        if (seeMoreSection.style.display === 'block') {
            seeMoreSection.style.display = 'none';
            button.textContent = 'See More';
        } else {
            seeMoreSection.style.display = 'block';
            button.textContent = 'See Less';
            window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' }); // Scroll to bottom
        }
    }
</script>
{% endblock %}
